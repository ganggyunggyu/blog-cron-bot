<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>í¬ë¡  ëŒ€ì‹œë³´ë“œ</title>
  <script src="/socket.io/socket.io.js"></script>
  <style>
    :root {
      --bg-primary: #f5f5f7;
      --bg-secondary: #ffffff;
      --bg-tertiary: #fafafa;
      --text-primary: #1d1d1f;
      --text-secondary: #86868b;
      --text-tertiary: #6e6e73;
      --accent: #0071e3;
      --success: #34c759;
      --warning: #ff9500;
      --danger: #ff3b30;
      --border: rgba(0, 0, 0, 0.08);
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04);
      --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 24px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 28px;
      font-weight: 600;
      letter-spacing: -0.5px;
      margin-bottom: 6px;
    }

    .header p {
      font-size: 15px;
      color: var(--text-secondary);
    }

    /* Status Badge */
    .status-bar {
      display: flex;
      justify-content: center;
      margin-bottom: 32px;
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      background: var(--bg-secondary);
      border-radius: 100px;
      box-shadow: var(--shadow-sm);
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
    }

    .status-badge.running {
      background: var(--success);
      color: white;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--text-tertiary);
    }

    .status-badge.running .status-dot {
      background: white;
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* Section */
    .section-title {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-secondary);
      margin-bottom: 12px;
      padding-left: 4px;
    }

    /* Job Grid */
    .job-section { margin-bottom: 24px; }

    .job-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 10px;
    }

    .job-card {
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      padding: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      border: 1px solid var(--border);
      text-align: center;
    }

    .job-card:hover:not(.disabled) {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .job-card.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .job-card .icon {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 10px;
      font-size: 18px;
    }

    .job-card .title {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .job-card .subtitle {
      font-size: 11px;
      color: var(--text-secondary);
      margin-top: 2px;
    }

    .icon-blue { background: rgba(0, 113, 227, 0.1); }
    .icon-purple { background: rgba(175, 82, 222, 0.1); }
    .icon-orange { background: rgba(255, 149, 0, 0.1); }
    .icon-green { background: rgba(52, 199, 89, 0.1); }
    .icon-pink { background: rgba(255, 45, 85, 0.1); }
    .icon-teal { background: rgba(90, 200, 250, 0.1); }
    .icon-indigo { background: rgba(88, 86, 214, 0.1); }
    .icon-red { background: rgba(255, 59, 48, 0.1); }
    .icon-yellow { background: rgba(255, 204, 0, 0.1); }
    .icon-mint { background: rgba(0, 199, 190, 0.1); }

    /* Controls */
    .controls {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 24px;
    }

    .btn {
      padding: 10px 20px;
      font-size: 13px;
      font-weight: 500;
      border: none;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.2s ease;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .btn-stop { background: var(--danger); color: white; }
    .btn-secondary { background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); }

    /* Progress Section */
    .progress-section {
      background: var(--bg-secondary);
      border-radius: var(--radius-lg);
      padding: 24px;
      margin-bottom: 24px;
      border: 1px solid var(--border);
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .progress-title {
      font-size: 16px;
      font-weight: 600;
    }

    .progress-percent {
      font-size: 24px;
      font-weight: 700;
      color: var(--accent);
    }

    .progress-bar-bg {
      height: 8px;
      background: var(--bg-primary);
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 16px;
    }

    .progress-bar-fill {
      height: 100%;
      background: var(--accent);
      border-radius: 4px;
      transition: width 0.3s ease;
      width: 0%;
    }

    .progress-info {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      text-align: center;
    }

    .progress-stat {
      padding: 12px;
      background: var(--bg-primary);
      border-radius: var(--radius-sm);
    }

    .progress-stat .num {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .progress-stat .label {
      font-size: 11px;
      color: var(--text-secondary);
      text-transform: uppercase;
    }

    .progress-stat.success .num { color: var(--success); }
    .progress-stat.warning .num { color: var(--warning); }

    .current-keyword {
      margin-top: 16px;
      padding: 12px 16px;
      background: var(--bg-primary);
      border-radius: var(--radius-sm);
      font-size: 13px;
    }

    .current-keyword .label {
      color: var(--text-secondary);
      font-size: 11px;
      margin-bottom: 4px;
    }

    .current-keyword .value {
      font-weight: 600;
      color: var(--text-primary);
    }

    /* Activity Feed */
    .activity-section {
      background: var(--bg-secondary);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      overflow: hidden;
    }

    .activity-header {
      padding: 16px 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .activity-header h2 {
      font-size: 14px;
      font-weight: 600;
    }

    .activity-list {
      max-height: 300px;
      overflow-y: auto;
    }

    .activity-item {
      padding: 12px 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .activity-item:last-child { border-bottom: none; }

    .activity-icon {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      flex-shrink: 0;
    }

    .activity-icon.success { background: rgba(52, 199, 89, 0.15); }
    .activity-icon.info { background: rgba(0, 113, 227, 0.15); }
    .activity-icon.warning { background: rgba(255, 149, 0, 0.15); }
    .activity-icon.error { background: rgba(255, 59, 48, 0.15); }

    .activity-content { flex: 1; min-width: 0; }

    .activity-content .title {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-primary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .activity-content .desc {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 2px;
    }

    .activity-time {
      font-size: 11px;
      color: var(--text-tertiary);
      flex-shrink: 0;
    }

    .empty-state {
      padding: 40px 20px;
      text-align: center;
      color: var(--text-secondary);
      font-size: 13px;
    }

    /* Stats Footer */
    .stats-footer {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 24px;
    }

    .stat-card {
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      padding: 16px;
      text-align: center;
      border: 1px solid var(--border);
    }

    .stat-card .label {
      font-size: 11px;
      color: var(--text-secondary);
      text-transform: uppercase;
      margin-bottom: 6px;
    }

    .stat-card .value {
      font-size: 18px;
      font-weight: 600;
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal {
      background: var(--bg-secondary);
      border-radius: var(--radius-lg);
      padding: 28px;
      width: 90%;
      max-width: 340px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
      text-align: center;
    }

    .modal-header {
      margin-bottom: 12px;
    }

    .modal-icon {
      font-size: 40px;
      display: block;
      margin-bottom: 12px;
    }

    .modal-header h3 {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .modal-desc {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 16px;
    }

    .modal-login-status {
      margin-bottom: 20px;
    }

    .login-badge {
      display: inline-block;
      padding: 6px 14px;
      border-radius: 100px;
      font-size: 13px;
      font-weight: 500;
    }

    .login-badge.logged-in {
      background: rgba(52, 199, 89, 0.15);
      color: #28a745;
    }

    .login-badge.logged-out {
      background: rgba(255, 149, 0, 0.15);
      color: #e67e00;
    }

    .modal-actions {
      display: flex;
      gap: 10px;
    }

    .modal-actions .btn {
      flex: 1;
      justify-content: center;
    }

    .btn-primary {
      background: var(--accent);
      color: white;
    }

    .btn-primary:hover {
      background: #0062cc;
    }

    /* Login Status in Progress */
    .login-indicator {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 12px;
      border-radius: 100px;
      font-size: 12px;
      font-weight: 500;
      margin-left: 12px;
    }

    .login-indicator.logged-in {
      background: rgba(52, 199, 89, 0.15);
      color: #28a745;
    }

    .login-indicator.logged-out {
      background: rgba(255, 149, 0, 0.15);
      color: #e67e00;
    }

    @media (max-width: 768px) {
      .container { padding: 20px 16px; }
      .job-grid { grid-template-columns: repeat(3, 1fr); }
      .progress-info { grid-template-columns: repeat(2, 1fr); }
      .stats-footer { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>í¬ë¡  ëŒ€ì‹œë³´ë“œ</h1>
      <p>ë¸”ë¡œê·¸ ë…¸ì¶œì²´í¬ ìë™í™”</p>
    </div>

    <div class="status-bar">
      <div class="status-badge" id="status">
        <span class="status-dot"></span>
        <span class="status-text">ëŒ€ê¸° ì¤‘</span>
      </div>
    </div>

    <div class="job-section">
      <div class="section-title">ê¸°ë³¸</div>
      <div class="job-grid">
        <div class="job-card" onclick="startJob('test')" data-job>
          <div class="icon icon-blue">ğŸ§ª</div>
          <div class="title">í…ŒìŠ¤íŠ¸</div>
        </div>
        <div class="job-card" onclick="startJob('pages')" data-job>
          <div class="icon icon-purple">ğŸ“„</div>
          <div class="title">Pages ì „ì²´</div>
        </div>
        <div class="job-card" onclick="startJob('root')" data-job>
          <div class="icon icon-orange">ğŸ </div>
          <div class="title">ë£¨íŠ¸</div>
        </div>
      </div>
    </div>

    <div class="job-section">
      <div class="section-title">Pages ì¹´í…Œê³ ë¦¬</div>
      <div class="job-grid">
        <div class="job-card" onclick="startJob('pages-black-goat')" data-job>
          <div class="icon icon-green">ğŸ</div>
          <div class="title">í‘ì—¼ì†Œ</div>
        </div>
        <div class="job-card" onclick="startJob('pages-herb-effect')" data-job>
          <div class="icon icon-mint">ğŸŒ¿</div>
          <div class="title">ì•½ì¬íš¨ëŠ¥</div>
        </div>
        <div class="job-card" onclick="startJob('pages-diet-supplement')" data-job>
          <div class="icon icon-pink">ğŸ’Š</div>
          <div class="title">ë‹¤ì´ì–´íŠ¸</div>
        </div>
        <div class="job-card" onclick="startJob('pages-skin-procedure')" data-job>
          <div class="icon icon-teal">âœ¨</div>
          <div class="title">í”¼ë¶€ì‹œìˆ </div>
        </div>
        <div class="job-card" onclick="startJob('pages-prescription')" data-job>
          <div class="icon icon-indigo">ğŸ“‹</div>
          <div class="title">ì•½ì²˜ë°©</div>
        </div>
        <div class="job-card" onclick="startJob('pages-dental')" data-job>
          <div class="icon icon-blue">ğŸ¦·</div>
          <div class="title">ì¹˜ê³¼</div>
        </div>
        <div class="job-card" onclick="startJob('pages-eye-clinic')" data-job>
          <div class="icon icon-purple">ğŸ‘ï¸</div>
          <div class="title">ì•ˆê³¼</div>
        </div>
        <div class="job-card" onclick="startJob('pages-pet')" data-job>
          <div class="icon icon-orange">ğŸ•</div>
          <div class="title">ì• ê²¬</div>
        </div>
        <div class="job-card" onclick="startJob('pages-hemorrhoid')" data-job>
          <div class="icon icon-red">ğŸ©º</div>
          <div class="title">ì¹˜ì§ˆ</div>
        </div>
        <div class="job-card" onclick="startJob('pages-suripet')" data-job>
          <div class="icon icon-yellow">ğŸ¾</div>
          <div class="title">ì„œë¦¬í«</div>
        </div>
      </div>
    </div>

    <div class="controls">
      <button class="btn btn-stop" onclick="stopJob()" id="stopBtn" disabled>â¹ ì¤‘ì§€</button>
      <button class="btn btn-secondary" onclick="clearActivity()">ğŸ—‘ ì´ˆê¸°í™”</button>
    </div>

    <!-- Progress -->
    <div class="progress-section" id="progressSection" style="display: none;">
      <div class="progress-header">
        <span class="progress-title">ì§„í–‰ ì¤‘<span class="login-indicator" id="loginIndicator" style="display: none;">-</span></span>
        <span class="progress-percent" id="progressPercent">0%</span>
      </div>
      <div class="progress-bar-bg">
        <div class="progress-bar-fill" id="progressBar"></div>
      </div>
      <div class="progress-info">
        <div class="progress-stat">
          <div class="num" id="statTotal">0</div>
          <div class="label">ì „ì²´</div>
        </div>
        <div class="progress-stat">
          <div class="num" id="statCurrent">0</div>
          <div class="label">ì²˜ë¦¬</div>
        </div>
        <div class="progress-stat success">
          <div class="num" id="statExposed">0</div>
          <div class="label">ë…¸ì¶œ</div>
        </div>
        <div class="progress-stat warning">
          <div class="num" id="statPopular">0</div>
          <div class="label">ì¸ê¸°ê¸€</div>
        </div>
      </div>
      <div class="current-keyword" id="currentKeyword" style="display: none;">
        <div class="label">í˜„ì¬ ì²˜ë¦¬ ì¤‘</div>
        <div class="value" id="currentKeywordText">-</div>
      </div>
    </div>

    <!-- Activity Feed -->
    <div class="activity-section">
      <div class="activity-header">
        <h2>í™œë™ ë¡œê·¸</h2>
        <span id="activityCount" style="font-size: 12px; color: var(--text-secondary);">0ê°œ</span>
      </div>
      <div class="activity-list" id="activityList">
        <div class="empty-state">ì•„ì§ í™œë™ì´ ì—†ìŠµë‹ˆë‹¤</div>
      </div>
    </div>

    <div class="stats-footer">
      <div class="stat-card">
        <div class="label">ë§ˆì§€ë§‰ ì‹¤í–‰</div>
        <div class="value" id="lastRun">-</div>
      </div>
      <div class="stat-card">
        <div class="label">ì‹¤í–‰ ì‹œê°„</div>
        <div class="value" id="duration">-</div>
      </div>
      <div class="stat-card">
        <div class="label">ìƒíƒœ</div>
        <div class="value" id="resultStatus">-</div>
      </div>
    </div>
  </div>

  <!-- í™•ì¸ ëª¨ë‹¬ -->
  <div class="modal-overlay" id="confirmModal" style="display: none;">
    <div class="modal">
      <div class="modal-header">
        <span class="modal-icon" id="modalIcon">ğŸ“„</span>
        <h3 id="modalTitle">ì‘ì—… í™•ì¸</h3>
      </div>
      <p class="modal-desc" id="modalDesc">ì´ ì‘ì—…ì„ ì‹¤í–‰í• ê¹Œìš”?</p>
      <div class="modal-login-status" id="modalLoginStatus">
        <span class="login-badge" id="loginBadge">ğŸŒ ë¹„ë¡œê·¸ì¸</span>
      </div>
      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="closeModal()">ì·¨ì†Œ</button>
        <button class="btn btn-primary" onclick="confirmStart()">ì‹¤í–‰</button>
      </div>
    </div>
  </div>

  <script>
    const socket = io();
    const statusEl = document.getElementById('status');
    const stopBtn = document.getElementById('stopBtn');
    const jobCards = document.querySelectorAll('[data-job]');
    const activityList = document.getElementById('activityList');
    const progressSection = document.getElementById('progressSection');

    let startTime = null;
    let timerInterval = null;
    let activityCount = 0;
    let stats = { total: 0, current: 0, exposed: 0, popular: 0 };
    let pendingJob = null;
    let isLoggedIn = false;

    const jobInfo = {
      'test': { icon: 'ğŸ§ª', name: 'í…ŒìŠ¤íŠ¸' },
      'pages': { icon: 'ğŸ“„', name: 'Pages ì „ì²´' },
      'root': { icon: 'ğŸ ', name: 'ë£¨íŠ¸' },
      'pages-black-goat': { icon: 'ğŸ', name: 'í‘ì—¼ì†Œ' },
      'pages-herb-effect': { icon: 'ğŸŒ¿', name: 'ì•½ì¬íš¨ëŠ¥' },
      'pages-diet-supplement': { icon: 'ğŸ’Š', name: 'ë‹¤ì´ì–´íŠ¸' },
      'pages-skin-procedure': { icon: 'âœ¨', name: 'í”¼ë¶€ì‹œìˆ ' },
      'pages-prescription': { icon: 'ğŸ“‹', name: 'ì•½ì²˜ë°©' },
      'pages-dental': { icon: 'ğŸ¦·', name: 'ì¹˜ê³¼' },
      'pages-eye-clinic': { icon: 'ğŸ‘ï¸', name: 'ì•ˆê³¼' },
      'pages-pet': { icon: 'ğŸ•', name: 'ì• ê²¬' },
      'pages-hemorrhoid': { icon: 'ğŸ©º', name: 'ì¹˜ì§ˆ' },
      'pages-suripet': { icon: 'ğŸ¾', name: 'ì„œë¦¬í«' },
    };

    socket.on('connect', () => addActivity('info', 'ì„œë²„ ì—°ê²°ë¨', 'ëŒ€ì‹œë³´ë“œ ì¤€ë¹„ ì™„ë£Œ'));
    socket.on('disconnect', () => addActivity('error', 'ì„œë²„ ì—°ê²° ëŠê¹€', 'ì¬ì—°ê²° ì‹œë„ ì¤‘...'));
    socket.on('status', (data) => updateStatus(data.running, data.job));
    socket.on('log', (text) => parseLog(text));
    socket.on('error', (msg) => addActivity('error', 'ì˜¤ë¥˜ ë°œìƒ', msg));

    socket.on('done', (data) => {
      const elapsed = startTime ? Math.floor((Date.now() - startTime) / 1000) : 0;
      document.getElementById('duration').textContent = formatDuration(elapsed);
      const resultEl = document.getElementById('resultStatus');
      resultEl.textContent = data.code === 0 ? 'ì„±ê³µ' : 'ì‹¤íŒ¨';
      resultEl.style.color = data.code === 0 ? 'var(--success)' : 'var(--danger)';
      addActivity(data.code === 0 ? 'success' : 'error', 'ì‘ì—… ì™„ë£Œ', `${formatDuration(elapsed)} ì†Œìš”`);
      if (timerInterval) { clearInterval(timerInterval); timerInterval = null; }
      progressSection.style.display = 'none';
    });

    function startJob(type) {
      pendingJob = type;
      const info = jobInfo[type] || { icon: 'ğŸ“„', name: type };

      document.getElementById('modalIcon').textContent = info.icon;
      document.getElementById('modalTitle').textContent = info.name + ' ì‹¤í–‰';
      document.getElementById('modalDesc').textContent = `"${info.name}" ì‘ì—…ì„ ì‹¤í–‰í• ê¹Œìš”?`;

      const loginBadge = document.getElementById('loginBadge');
      loginBadge.textContent = isLoggedIn ? 'ğŸ” ë¡œê·¸ì¸ ëª¨ë“œ' : 'ğŸŒ ë¹„ë¡œê·¸ì¸ ëª¨ë“œ';
      loginBadge.className = 'login-badge ' + (isLoggedIn ? 'logged-in' : 'logged-out');

      document.getElementById('confirmModal').style.display = 'flex';
    }

    function closeModal() {
      document.getElementById('confirmModal').style.display = 'none';
      pendingJob = null;
    }

    function confirmStart() {
      if (!pendingJob) return;

      const type = pendingJob;
      closeModal();

      socket.emit('start', type);
      startTime = Date.now();
      stats = { total: 0, current: 0, exposed: 0, popular: 0 };
      updateStats();
      document.getElementById('lastRun').textContent = new Date().toLocaleTimeString('ko-KR');
      document.getElementById('resultStatus').textContent = 'ì‹¤í–‰ ì¤‘';
      document.getElementById('resultStatus').style.color = 'var(--warning)';
      progressSection.style.display = 'block';

      const loginIndicator = document.getElementById('loginIndicator');
      loginIndicator.style.display = 'none';

      addActivity('info', 'ì‘ì—… ì‹œì‘', type.toUpperCase());
      timerInterval = setInterval(() => {
        const elapsed = Math.floor((Date.now() - startTime) / 1000);
        document.getElementById('duration').textContent = formatDuration(elapsed);
      }, 1000);
    }

    function stopJob() { socket.emit('stop'); }

    function clearActivity() {
      activityList.innerHTML = '<div class="empty-state">ì•„ì§ í™œë™ì´ ì—†ìŠµë‹ˆë‹¤</div>';
      activityCount = 0;
      document.getElementById('activityCount').textContent = '0ê°œ';
    }

    function parseLog(text) {
      const clean = text.replace(/\x1b\[[0-9;]*m/g, '').replace(/\[[\d;]*m/g, '');

      // ë¡œê·¸ì¸ ìƒíƒœ íŒŒì‹±
      if (clean.includes('ğŸ”') || clean.includes('ë¡œê·¸ì¸ ëª¨ë“œ')) {
        isLoggedIn = true;
        updateLoginIndicator(true);
        addActivity('info', 'ë¡œê·¸ì¸ ëª¨ë“œ', 'ë„¤ì´ë²„ ë¡œê·¸ì¸ ìƒíƒœë¡œ í¬ë¡¤ë§');
      }
      if (clean.includes('ğŸŒ') || clean.includes('ë¹„ë¡œê·¸ì¸ ëª¨ë“œ')) {
        isLoggedIn = false;
        updateLoginIndicator(false);
        addActivity('info', 'ë¹„ë¡œê·¸ì¸ ëª¨ë“œ', 'ê²ŒìŠ¤íŠ¸ ìƒíƒœë¡œ í¬ë¡¤ë§');
      }

      // ì§„í–‰ë¥  íŒŒì‹±: [  1/316]
      const progressMatch = clean.match(/\[\s*(\d+)\/(\d+)\]/);
      if (progressMatch) {
        stats.current = parseInt(progressMatch[1]);
        stats.total = parseInt(progressMatch[2]);
        updateStats();
      }

      // í‚¤ì›Œë“œ íŒŒì‹±: ğŸ” í‚¤ì›Œë“œ (9â†’3 ìŠ¤ë¸”)
      const keywordMatch = clean.match(/ğŸ”\s*(.+?)\s*\(/);
      if (keywordMatch) {
        document.getElementById('currentKeyword').style.display = 'block';
        document.getElementById('currentKeywordText').textContent = keywordMatch[1].trim();
      }

      // ë…¸ì¶œ ë°œê²¬: âœ“ "í‚¤ì›Œë“œ" â†’ ë¸”ë¡œê·¸
      const exposedMatch = clean.match(/âœ“\s*"(.+?)"\s*â†’\s*(.+?)\s/);
      if (exposedMatch) {
        stats.exposed++;
        updateStats();
        addActivity('success', exposedMatch[1], exposedMatch[2]);
      }

      // ì¸ê¸°ê¸€ ì²´í¬
      if (clean.includes('ì¸ê¸°ê¸€') || clean.includes('ì¸ê¸°)')) {
        stats.popular++;
        updateStats();
      }

      // ì™„ë£Œ ë©”ì‹œì§€
      if (clean.includes('ì™„ë£Œ') && clean.includes('ë…¸ì¶œ')) {
        const completeMatch = clean.match(/(\d+)ê°œ\s*ë…¸ì¶œ/);
        if (completeMatch) {
          addActivity('success', 'ì‹œíŠ¸ ì™„ë£Œ', `${completeMatch[1]}ê°œ ë…¸ì¶œ ë°œê²¬`);
        }
      }

      // ì—ëŸ¬
      if (clean.includes('ì—ëŸ¬') || clean.includes('ì‹¤íŒ¨')) {
        addActivity('error', 'ì˜¤ë¥˜', clean.substring(0, 50));
      }
    }

    function updateLoginIndicator(loggedIn) {
      const indicator = document.getElementById('loginIndicator');
      indicator.style.display = 'inline-flex';
      indicator.textContent = loggedIn ? 'ğŸ” ë¡œê·¸ì¸' : 'ğŸŒ ë¹„ë¡œê·¸ì¸';
      indicator.className = 'login-indicator ' + (loggedIn ? 'logged-in' : 'logged-out');
    }

    function updateStats() {
      document.getElementById('statTotal').textContent = stats.total;
      document.getElementById('statCurrent').textContent = stats.current;
      document.getElementById('statExposed').textContent = stats.exposed;
      document.getElementById('statPopular').textContent = stats.popular;

      const percent = stats.total > 0 ? Math.round((stats.current / stats.total) * 100) : 0;
      document.getElementById('progressPercent').textContent = percent + '%';
      document.getElementById('progressBar').style.width = percent + '%';
    }

    function addActivity(type, title, desc) {
      if (activityList.querySelector('.empty-state')) {
        activityList.innerHTML = '';
      }

      const icons = { success: 'âœ“', info: 'â„¹', warning: 'âš ', error: 'âœ•' };
      const item = document.createElement('div');
      item.className = 'activity-item';
      item.innerHTML = `
        <div class="activity-icon ${type}">${icons[type] || 'â€¢'}</div>
        <div class="activity-content">
          <div class="title">${title}</div>
          <div class="desc">${desc}</div>
        </div>
        <div class="activity-time">${new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' })}</div>
      `;

      activityList.insertBefore(item, activityList.firstChild);
      activityCount++;
      document.getElementById('activityCount').textContent = activityCount + 'ê°œ';

      // ìµœëŒ€ 50ê°œ ìœ ì§€
      while (activityList.children.length > 50) {
        activityList.removeChild(activityList.lastChild);
      }
    }

    function updateStatus(running, job) {
      const statusText = statusEl.querySelector('.status-text');
      if (running) {
        statusText.textContent = `ì‹¤í–‰ ì¤‘: ${job?.toUpperCase()}`;
        statusEl.classList.add('running');
        stopBtn.disabled = false;
        jobCards.forEach(card => card.classList.add('disabled'));
      } else {
        statusText.textContent = 'ëŒ€ê¸° ì¤‘';
        statusEl.classList.remove('running');
        stopBtn.disabled = true;
        jobCards.forEach(card => card.classList.remove('disabled'));
      }
    }

    function formatDuration(seconds) {
      const h = Math.floor(seconds / 3600);
      const m = Math.floor((seconds % 3600) / 60);
      const s = seconds % 60;
      if (h > 0) return `${h}ì‹œê°„ ${m}ë¶„`;
      if (m > 0) return `${m}ë¶„ ${s}ì´ˆ`;
      return `${s}ì´ˆ`;
    }
  </script>
</body>
</html>
